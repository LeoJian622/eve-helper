# EVE Helper DDD架构迁移计划

## 迁移概述

本计划将按照DDD架构原则，将现有的EVE Helper项目从传统分层架构迁移到领域驱动设计架构。

## 当前项目结构分析

### 现有目录结构
```
src/main/java/xyz/foolcat/eve/evehelper/
├── domain/          # 已存在的领域层（部分）
├── application/     # 已存在的应用层（部分）
├── infrastructure/  # 已存在的基础设施层（部分）
├── interfaces/      # 已存在的接口层（部分）
├── shared/          # 已存在的共享层（部分）
├── vo/              # 视图对象（需要迁移）
├── util/            # 工具类（需要迁移）
├── task/            # 任务类（需要迁移）
├── onebot/          # OneBot集成（需要迁移）
├── exception/       # 异常类（需要迁移）
├── init/            # 初始化类（需要迁移）
├── esi/             # ESI集成（需要迁移）
├── enums/           # 枚举类（需要迁移）
├── converter/       # 转换器（需要迁移）
├── controller/      # 控制器（需要迁移）
├── config/          # 配置类（需要迁移）
├── service/         # 服务类（需要迁移）
├── dto/             # 数据传输对象（需要迁移）
├── common/          # 通用组件（需要迁移）
└── mapper/          # 数据访问层（需要迁移）
```

## 迁移目标架构

### 目标DDD目录结构
```
src/main/java/xyz/foolcat/eve/evehelper/
├── domain/                    # 领域层 - 核心业务逻辑
│   ├── model/
│   │   ├── entity/           # 实体（聚合根）
│   │   ├── valueobject/      # 值对象
│   │   └── aggregate/        # 聚合根
│   ├── repository/           # 仓储接口
│   ├── service/              # 领域服务
│   ├── event/                # 领域事件
│   └── specification/        # 规格模式
├── application/              # 应用层 - 用例协调
│   ├── service/              # 应用服务
│   ├── dto/
│   │   ├── command/          # 命令DTO
│   │   ├── query/            # 查询DTO
│   │   └── response/         # 响应DTO
│   ├── assembler/            # 组装器
│   ├── event/                # 应用事件
│   └── validator/            # 验证器
├── infrastructure/           # 基础设施层 - 技术实现
│   ├── persistence/          # 持久化实现
│   │   ├── mapper/           # MyBatis映射器
│   │   ├── repository/       # 仓储实现
│   │   └── entity/           # 数据库实体
│   ├── external/             # 外部服务集成
│   │   ├── esi/              # ESI服务
│   │   └── onebot/           # OneBot服务
│   ├── config/               # 配置类
│   ├── cache/                # 缓存实现
│   ├── message/              # 消息队列
│   ├── file/                 # 文件处理
│   └── util/                 # 工具类
├── interfaces/               # 接口层 - 用户交互
│   ├── web/                  # Web接口
│   │   ├── controller/       # 控制器
│   │   ├── filter/           # 过滤器
│   │   ├── advice/           # 异常处理
│   │   └── vo/               # 视图对象
│   ├── websocket/            # WebSocket接口
│   ├── cli/                  # 命令行接口
│   └── facade/               # 外观模式
└── shared/                   # 共享层 - 通用组件
    ├── kernel/               # 核心组件
    │   ├── base/             # 基础类
    │   ├── enums/            # 枚举定义
    │   ├── exception/        # 异常定义
    │   └── constants/        # 常量定义
    ├── result/               # 统一返回结果
    ├── security/             # 安全相关
    ├── validation/           # 验证组件
    └── util/                 # 通用工具类
```

## 迁移步骤

### 第一阶段：完善DDD目录结构
1. 创建缺失的目录结构
2. 移动现有文件到正确位置
3. 更新包名和导入语句

### 第二阶段：领域层迁移
1. 迁移实体类到domain/model/entity/
2. 迁移值对象到domain/model/valueobject/
3. 创建聚合根
4. 迁移领域服务
5. 创建领域事件

### 第三阶段：应用层迁移
1. 迁移应用服务
2. 重组DTO结构
3. 创建组装器
4. 添加验证器

### 第四阶段：基础设施层迁移
1. 迁移持久化相关代码
2. 迁移外部服务集成
3. 迁移配置类
4. 创建缓存和消息队列实现

### 第五阶段：接口层迁移
1. 迁移Web控制器
2. 迁移WebSocket接口
3. 迁移命令行接口
4. 优化异常处理

### 第六阶段：共享层迁移
1. 迁移通用组件
2. 统一异常处理
3. 标准化返回结果
4. 完善工具类

## 迁移优先级

### 高优先级（核心业务）
- 用户管理相关代码
- 角色管理相关代码
- 蓝图管理相关代码
- 资产管理相关代码

### 中优先级（应用服务）
- 应用服务层
- DTO和组装器
- 验证逻辑

### 低优先级（基础设施）
- 外部服务集成
- 配置类
- 工具类

## 注意事项

1. **保持向后兼容**：确保迁移过程中系统仍能正常运行
2. **逐步迁移**：按模块逐步迁移，不要一次性重构
3. **测试覆盖**：确保每个迁移步骤都有充分的测试
4. **依赖管理**：正确处理包名变更和依赖关系
5. **文档更新**：及时更新相关文档和注释

## 预期收益

1. **清晰的业务边界**：领域模型清晰表达业务概念
2. **更好的可维护性**：分层明确，职责清晰
3. **更强的可扩展性**：易于添加新功能
4. **更好的测试性**：各层可以独立测试
5. **团队协作**：不同角色可以专注于不同层
6. **业务与技术分离**：业务逻辑与技术实现分离 